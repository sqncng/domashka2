#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область ПрограммныйИнтерфейс

// Помещает справку в буфер обмена
//
// Параметры:
//   ДанныеБуфера (Структура("ТаблицаСправки,ТаблицаСсылок")) Структура, хранящая таблицу справки и таблицу ссылок
Процедура ПоместитьСправкуВБуферОбмена(ДанныеБуфера) Экспорт
		
	ХранилищаНастроек.ХранилищеБуфераОбмена.Сохранить("БуфераОбмена", "Справка", ДанныеБуфера, , );
КонецПроцедуры 

// Получает справку из буфера обмена
//
// Возвращаемое значение:
// ДанныеБуфера (Структура("ТаблицаСправки,ТаблицаСсылок"))   - Структура с текстом справки и ссылками
Функция ПолучитьСправкуИзБуфераОбмена() Экспорт
	
	ДанныеБуфера = ХранилищаНастроек.ХранилищеБуфераОбмена.Загрузить("БуфераОбмена","Справка", , );
	
	Возврат ДанныеБуфера;
	
КонецФункции 

// Проверяет буфер обмена на заполненность
Функция БуферОбменаПустой() Экспорт
	
	Возврат (ХранилищаНастроек.ХранилищеБуфераОбмена.Загрузить("БуфераОбмена","Справка", , ) = Неопределено)

КонецФункции 

// Очищает буфер обмена
Процедура ОчиститьБуферОбмена() Экспорт
	
	ОбщегоНазначения.ХранилищеНастроекДанныхФормУдалить("БуфераОбмена", "Справка", ИмяПользователя());
	
КонецПроцедуры 

#КонецОбласти

#Область ОбработчикиСобытий

// Обработчик чтения данных из буфера обмена
//
// Параметры:
//   КлючОбъекта       (Строка) Полное имя объекта
//   КлючНастроек     (Строка) Ключ сохраняемых данных
//   Настройки        (*) Настройки варианта отчета
//   ОписаниеНастроек (ОписаниеНастроек)
//   Пользователь     (Строка) Имя пользователя ИБ
Процедура ОбработкаЗагрузки(КлючОбъекта, КлючНастроек, Настройки, ОписаниеНастроек, Пользователь)
	Настройки = ОбщегоНазначения.ХранилищеНастроекДанныхФормЗагрузить(КлючОбъекта, КлючНастроек);
КонецПроцедуры

// Обработчик записи данных в буфера обмена
//
// Параметры:
//   КлючОбъекта       (Строка) Полное имя отчета с точкой
//   КлючНастроек     (Строка) Ключ варианта отчета
//   Настройки        (*) Настройки варианта отчета
//   ОписаниеНастроек (ОписаниеНастроек, Неопределено)
//   Пользователь     (Строка, Неопределено) Имя пользователя ИБ
//       Не используется, так как подсистема "Варианты отчетов" не разделяет варианты по авторам.
//       Уникальность хранения и выборки гарантируется уникальностью пар ключей отчетов и вариантов.
//
Процедура ОбработкаСохранения(КлючОбъекта, КлючНастроек, Настройки, ОписаниеНастроек, Пользователь)
	ОбщегоНазначения.ХранилищеНастроекДанныхФормСохранить(КлючОбъекта, КлючНастроек, Настройки);
КонецПроцедуры

#КонецОбласти

#КонецЕсли
